# å¸¸è§èœœç½ä½“éªŒå’Œæ¢ç´¢ 
--- 
## å®éªŒç›®çš„  
* äº†è§£èœœç½çš„åˆ†ç±»å’ŒåŸºæœ¬åŸç†
* äº†è§£ä¸åŒç±»å‹èœœç½çš„é€‚ç”¨åœºåˆ
* æŒæ¡å¸¸è§èœœç½çš„æ­å»ºå’Œä½¿ç”¨   
## å®éªŒè¦æ±‚  
- [x] è®°å½•èœœç½çš„è¯¦ç»†æ­å»ºè¿‡ç¨‹
- [x] ä½¿ç”¨nmapæ‰«ææ­å»ºå¥½çš„èœœç½å¹¶åˆ†ææ‰«æç»“æœï¼ŒåŒæ—¶åˆ†æã€Œnmapæ‰«ææœŸé—´ã€èœœç½ä¸Šè®°å½•å¾—åˆ°çš„ä¿¡æ¯  

- [x] å¦‚ä½•è¾¨åˆ«å½“å‰ç›®æ ‡æ˜¯ä¸€ä¸ªã€Œèœœç½ã€ï¼Ÿä»¥è‡ªå·±æ­å»ºçš„èœœç½ä¸ºä¾‹è¿›è¡Œè¯´æ˜
- [x] æ€»ç»“å¸¸è§çš„èœœç½è¯†åˆ«å’Œæ£€æµ‹æ–¹æ³•  
## ç½‘ç»œæ‹“æ‰‘  
![](img\topology.PNG)
---  
## å®éªŒè¿‡ç¨‹  
### ä½äº¤äº’èœœç½ ssh-honeypot  
* å®‰è£…dockerï¼ˆæŒ‰ç…§å®˜æ–¹æ•™ç¨‹ï¼‰  
  * æ·»åŠ docker-ceçš„aptæº  
  ```  
  apt-get update
  apt-get install -y apt-transport-https ca-certificates curl software-properties-common
  curl -fsSL https://download.daocloud.io/docker/linux/ubuntu/gpg | sudo apt-key add -  
  ```  
  * æ·»åŠ dockerçš„å¯†é’¥  
  ```
  curl -fsSL https://download.docker.com/linux/debian/gpg | sudo apt-key add -  
  ```  
  * éªŒè¯å¯†é’¥çš„å¯ç”¨æ€§å¹¶è¿›è¡Œdocker-ceçš„å®‰è£…  
  ```  
  sudo apt-key fingerprint 0EBFCD88
  sudo apt-get update
  sudo apt-get install docker-ce# å®‰è£… Docker  
  ```  
  * å¼€å¯dockeræœåŠ¡å¹¶æµ‹è¯•æ˜¯å¦å®‰è£…æˆåŠŸ  
  ```  
  systemctl start docker
  sudo docker run hello-world  
  ```  
  ![](img\docker.PNG)  
* å®‰è£…ssh-honeypot  
    ```  
    apt install libssh-dev libjson-c-dev  # å®‰è£…ä¾èµ–é¡¹ 
    ssh-keygen -t rsa -f ./ssh-honeypot.rsa  # å…ˆå°†sshå¯†ç ç½®ä¸ºç©º
    git clone https://github.com/random-robbie/docker-ssh-honey
    docker build . -t local:ssh-honeypot#æ„å»ºé•œåƒ
    docker run -p 2234:22 local:ssh-honeypot# è¿è¡Œé•œåƒ æ ¼å¼ä¸ºæœ¬åœ°ç«¯å£:å®¹å™¨ç«¯å£  
    docker ps #æŸ¥çœ‹å®¹å™¨id
    docker exec -i -t id bash #ç”¨idè¿›å…¥å®¹å™¨
    tail -F ssh-honeypot.log#æŸ¥çœ‹æ—¥å¿—  
    ```  
    ![](img\bash.PNG)  
* æ²¡è¿›è¡Œsshè¿æ¥æ—¶ï¼ŒæŸ¥çœ‹é¶æœºæ—¥å¿—  
![](img\before-log.PNG)  
æ—¥å¿—ä¸Šæ²¡æœ‰ä»»ä½•è®°å½•   

* åœ¨æ”»å‡»è€…ä¸»æœºä¸Šå¯¹èœœç½æ‰€åœ¨ä¸»æœºç«¯å£è¿›è¡Œsshè¿æ¥  
![](img\after-log.PNG)  
å¯ä»¥çœ‹åˆ°ï¼Œå‘èµ·è¿æ¥çš„ä¸»æœºåœ°å€è¢«è®°å½•ï¼Œå°è¯•sshè¿æ¥æ—¶è¾“å…¥çš„è´¦å·å¯†ç ä¹Ÿè¢«è®°å½•ï¼Œå¹¶ä¸”æ— è®ºè¾“å…¥å¯†ç æ­£ç¡®ä¸å¦ï¼Œéƒ½æ— æ³•å»ºç«‹sshè¿æ¥   
* å¯¹é¶æœºè¿›è¡Œnmapæ‰«æï¼Œå‘ç°è¡Œä¸ºæ²¡æœ‰è¢«è®°å½•ä¸‹æ¥  
![](img\ssh-nmap.PNG)   
å†æ¬¡è¯´æ˜äº†è¿™æ˜¯ä¸€ä¸ªä½äº¤äº’çš„èœœç½ï¼Œåªèƒ½æ¨¡æ‹Ÿç™»å½•è¿‡ç¨‹å¹¶è®°å½•ç™»å½•è¡Œä¸ºï¼Œå¹¶ä¸èƒ½æ¨¡æ‹Ÿç™»å½•çš„æƒ…å†µã€‚  
### ä¸­ç­‰äº¤äº’èœœç½ cowrie  
* å®‰è£…cowrie  
```  
docker pull cowrie/cowrie  
docker run -p 2222:2222 cowrie/cowrie  
```   
* å¯¹èœœç½æ‰€åœ¨ç«¯å£è¿›è¡Œsshè¿æ¥ï¼ŒæŸ¥çœ‹æ—¥å¿—ï¼ˆåœ¨/cowrie/cowrie-git/var/log/cowrie/cowrie.jsonè·¯å¾„ä¸‹ï¼‰
![](img\co-log.PNG)    
å¹¶ä¸”å‘ç°ï¼Œä½¿ç”¨rootç”¨æˆ·åç™»å½•æ—¶ï¼Œæ— è®ºå¯†ç æ­£ç¡®ä¸å¦éƒ½èƒ½ç™»å½•ï¼›ä½¿ç”¨å…¶ä»–ç”¨æˆ·æ— è®ºå¯†ç æ­£ç¡®ä¸å¦éƒ½ç™»å½•ä¸ä¸Š  
![](img\co-kali.PNG)
![](img\co-root.PNG)  
ä¸€æ®µæ—¶é—´åï¼Œsshè¿æ¥è‡ªåŠ¨æ–­å¼€  
![](img\co-close-connection.PNG)
* åœ¨æ”»å‡»è€…ä¸»æœºä¸Šå¯¹é¶æœºè¿›è¡Œnmapæ‰«æ  
![](img\co-nmap.PNG)  
æŸ¥çœ‹æ—¥å¿—ï¼Œå‘ç°åˆšæ‰çš„æ‰«æè¡Œä¸ºæ²¡æœ‰è¢«è®°å½•  
![](img\co-aflog.PNG)  
* ç”¨rootç”¨æˆ·ç™»å½•åå¯¹èœœç½è¿›è¡Œæ¢ç´¢  
  * ping  
  ![](img\co-ping.PNG)  
    * èœœç½ç»™å‡ºä¸€äº›å‡æ•°æ®æ¨¡æ‹Ÿå›åº”ï¼Œå…¶å®è¿™é‡Œçš„218.177.158.130æ ¹æœ¬ä¸æ˜¯ç™¾åº¦çš„ipåœ°å€  
    ![](img\218.PNG)  
  * curl  
  ![](img\co-curl.PNG)    
  çœ‹èµ·æ¥å¥½åƒçœŸçš„ä¸‹è½½äº†ç½‘é¡µæ•°æ®  
  å†æ¥curlä¸€ä¸ªä¸å­˜åœ¨ç½‘é¡µhahaha  
  ![](img\curl-hahaha.PNG)  
  æ­£å¸¸æ˜¯ä¸ä¼šè¿”å›æ•°æ®çš„ 
  ![](img\curl-haha.PNG)   
  * æƒ³åˆ°curlå°±å†æ¢ç´¢ä¸€ä¸‹wget  
   ![](img\wget.PNG)  
   å¯ä»¥è¯´æ˜¯å¾ˆæ˜æ˜¾äº†ğŸ˜‚
  * è¾“å…¥aptç›¸å…³æŒ‡ä»¤  
  å…ˆæ¥å®‰è£…ä¸€ä¸ªä¸å­˜åœ¨çš„è½¯ä»¶åŒ…  
  ![](img\apt-get1.PNG)  
  é‡å¤æ‰§è¡Œä¸€ä¸‹åˆšæ‰çš„æŒ‡ä»¤  
  ![](img\co-apt2.PNG)    
  ä½†æ˜¯æ­£å¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœè¿™ä¸ªåŒ…å·²ç»è¢«å®‰è£…è¿‡åº”è¯¥æ˜¯ä¸‹é¢è¿™æ ·çš„ç»“æœ  
  ![](img\right-apt.PNG)  
  * æœ€åæ¥çœ‹ä¸€ä¸‹è¿™ä¸ªèœœç½å¯ä»¥æ¨¡æ‹Ÿçš„æŒ‡ä»¤,åœ¨è¿™ä¸ªè·¯å¾„ä¸‹```~/cowrie-git/share/cowrie/txtcmds/bin/enable```
  ![](img\co-command.PNG)  
  å¯ä»¥æ¨¡æ‹Ÿçš„å‘½ä»¤è¿˜æ˜¯æŒºå¤šçš„  
  ---  
  ## å®éªŒæ€»ç»“  
  **å¸¸è§çš„èœœç½è¯†åˆ«å’Œæ£€æµ‹æ–¹æ³•**    
  * å®éªŒä¸­çš„æ„Ÿå—  
    * å¦‚æœæ¯«ä¸è´¹åŠ›çš„å°±èƒ½è¿›å…¥ç›®æ ‡ï¼Œè¯´æ˜å¯èƒ½è§¦å‘çš„æ˜¯èœœç½  
    * å¤šå°è¯•å‡ ä¸ªå‘½ä»¤ï¼Œæˆ–è€…å¯¹æŸä¸€ä¸ªå‘½ä»¤å¤šæ·»åŠ ä¸€äº›ä¸å¸¸è§é€‰é¡¹ï¼Œæˆ–è€…æ•…æ„ä½¿ç”¨é”™è¯¯å£ä»¤éƒ½å¯èƒ½ä¼šæ¼å‡ºç ´ç»½  
  * å‚è€ƒç½‘ä¸Šçš„ç†è®º 
    * é…ç½®å¤±çœŸä¸èµ„æºæŠ¢å¤º  
    > ä½äº¤äº’èœœç½æ˜¯ä¸èƒ½å¤Ÿç»™æ•Œäººæä¾›ä¸€ä¸ªå®Œæ•´çš„æ“ä½œç³»ç»Ÿç¯å¢ƒï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ä½¿ç”¨ä¸€äº›å¤æ‚çš„å‘½ä»¤å’Œæ“ä½œï¼Œä»¥åŠä¸€äº›æƒ³ä¸åˆ°çš„è¾“å‡ºè§£å†³æ¥æ£€æŸ¥æ˜¯ä¸æ˜¯å¤„åœ¨èœœç½ç¯å¢ƒä¸­ã€‚  
    > æ“ä½œç³»ç»Ÿä¸å¯èƒ½æŠŠæ‰€æœ‰çš„èµ„æºéƒ½åˆ†é…ç»™èœœç½ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨èœœç½ä¸­æ‰§è¡Œä¸€ä¸ªå¾ˆç¹çå¾ˆè€—èµ„æºçš„æ“ä½œï¼Œè¿™æ ·èœœç½å°±ä¼šå’Œå…¶ä»–æœåŠ¡è¿›ç¨‹å»äº‰æŠ¢èµ„æºï¼Œæœ€ç›´è§‚çš„æ„Ÿå—å°±æ˜¯èœœç½çš„ååº”é€Ÿåº¦ä¼šæ…¢ä¸‹æ¥ã€‚
    * æ•°æ®åŒ…æ—¶é—´æˆ³åˆ†æ  
    > å¦‚æœæˆ‘ä»¬ä»…é€šè¿‡æŸ¥çœ‹ç½‘ç»œæ•°æ®åŒ…èƒ½å¾ˆå®¹æ˜“çš„æ¨æ–­å‡ºä¸€ä¸ªæœºå™¨çš„ç‰©ç†å±æ€§ï¼Œæˆ‘ä»¬å°±å¾ˆæœ‰å¯èƒ½è¾¨åˆ«ç‰©ç†æœåŠ¡å™¨å’Œè™šæ‹Ÿèœœç½ã€‚äº‹å®è¯æ˜ï¼ŒTCPæä¾›äº†ä¸€äº›ç›´æ¥åæ˜ åº•å±‚æœåŠ¡å™¨çŠ¶æ€çš„ä¿¡æ¯ã€‚TCPæ—¶é—´æˆ³é€‰é¡¹è¢«ç½‘ç»œå †æ ˆç”¨äºç¡®å®šé‡ä¼ è¶…æ—¶æ—¶é—´ã€‚æœºå™¨ä¸­çš„æ— å†å²ä¸­å®‰ç‰¹å®šé¢‘ç‡æ›´æ–°æ—¶é—´æˆ³ï¼Œæˆ‘ä»¬ä¹ŸçŸ¥é“ï¼Œæ‰€æœ‰çš„ç‰©ç†æ—¶é’Ÿéƒ½æœ‰ä¸€å®šæ—¶é’Ÿåå·®ï¼Œä»–ä»¬æˆ–å¤šæˆ–å°‘äºå®é™…è¿è¡Œæ—¶é—´ã€‚  

  ## å‚è€ƒèµ„æ–™  
  [å®‰è£…docker](https://medium.com/@calypso_bronte/installing-docker-in-kali-linux-2018-1-ef3a8ce3648)  
  [doocker-cowrie](https://github.com/cowrie/docker-cowrie)  
  [cowrie-document](https://cowrie.readthedocs.io/en/latest/index.html)  
  [å¸ˆå§çš„å®éªŒæŠ¥å‘Š](https://github.com/CUCCS/2019-NS-Public-YanhuiJessica/tree/ns0x11/ns-0x11)   
  [èœœç½åˆè¯†](https://blog.csdn.net/jemy369/article/details/93722594)


